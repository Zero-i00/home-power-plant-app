from sqlalchemy import select
from sqlalchemy.ext.asyncio import AsyncSession
from models.city import CityModel, CityParameterModel, MonthEnum


MONTHS = [
    MonthEnum.JANUARY, MonthEnum.FEBRUARY, MonthEnum.MARCH, MonthEnum.APRIL,
    MonthEnum.MAY, MonthEnum.JUNE, MonthEnum.JULY, MonthEnum.AUGUST,
    MonthEnum.SEPTEMBER, MonthEnum.OCTOBER, MonthEnum.NOVEMBER, MonthEnum.DECEMBER
]

# Air density correction coefficients by city (multiplied by 100 to store as int)
AIR_DENSITY_DATA = {
    "Москва": [130, 129, 127, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Санкт-Петербург": [132, 131, 128, 121, 116, 113, 114, 116, 120, 126, 129, 131],
    "Новосибирск": [134, 133, 129, 122, 116, 113, 114, 116, 121, 127, 130, 133],
    "Екатеринбург": [133, 132, 128, 121, 115, 112, 113, 115, 120, 126, 129, 132],
    "Казань": [132, 131, 128, 121, 115, 112, 113, 115, 120, 125, 129, 131],
    "Нижний Новгород": [132, 131, 128, 121, 115, 112, 113, 115, 120, 125, 129, 131],
    "Челябинск": [133, 132, 129, 122, 116, 113, 114, 116, 121, 126, 130, 132],
    "Самара": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Омск": [134, 133, 129, 122, 116, 113, 114, 116, 121, 127, 130, 133],
    "Ростов-на-Дону": [128, 127, 124, 118, 114, 111, 112, 114, 118, 122, 125, 127],
    "Уфа": [132, 131, 128, 121, 116, 113, 114, 116, 120, 125, 129, 131],
    "Красноярск": [135, 134, 130, 123, 117, 114, 115, 117, 122, 128, 131, 134],
    "Воронеж": [130, 129, 126, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Пермь": [133, 132, 129, 122, 116, 113, 114, 116, 121, 126, 130, 132],
    "Волгоград": [129, 128, 125, 119, 115, 112, 113, 114, 118, 123, 126, 128],
    "Краснодар": [127, 126, 123, 118, 114, 111, 112, 114, 117, 121, 124, 126],
    "Саратов": [130, 129, 126, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Тюмень": [134, 133, 129, 122, 116, 113, 114, 116, 121, 127, 130, 133],
    "Тольятти": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Ижевск": [133, 132, 129, 122, 116, 113, 114, 116, 121, 126, 130, 132],
    "Барнаул": [134, 133, 129, 122, 116, 113, 114, 116, 121, 127, 130, 133],
    "Ульяновск": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Иркутск": [136, 135, 131, 124, 118, 115, 116, 118, 123, 129, 132, 135],
    "Хабаровск": [135, 134, 129, 122, 117, 114, 115, 117, 122, 127, 131, 134],
    "Ярославль": [132, 131, 128, 121, 116, 113, 114, 116, 120, 125, 129, 131],
    "Владивосток": [133, 132, 128, 121, 116, 113, 114, 116, 121, 126, 130, 132],
    "Махачкала": [126, 125, 123, 118, 114, 112, 113, 114, 117, 121, 124, 125],
    "Томск": [135, 134, 130, 123, 117, 114, 115, 117, 122, 128, 131, 134],
    "Кемерово": [135, 134, 130, 123, 117, 114, 115, 117, 122, 128, 131, 134],
    "Набережные Челны": [132, 131, 128, 121, 115, 112, 113, 115, 120, 125, 129, 131],
    "Оренбург": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Тула": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Киров": [133, 132, 129, 122, 116, 113, 114, 116, 121, 126, 130, 132],
    "Чебоксары": [132, 131, 128, 121, 115, 112, 113, 115, 120, 125, 129, 131],
    "Калининград": [131, 130, 127, 121, 116, 113, 114, 116, 120, 125, 128, 130],
    "Брянск": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Курск": [130, 129, 126, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Липецк": [130, 129, 126, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Сочи": [124, 123, 121, 117, 114, 112, 113, 114, 116, 119, 122, 123],
    "Ставрополь": [128, 127, 124, 118, 114, 111, 112, 114, 118, 122, 125, 127],
    "Владикавказ": [125, 124, 122, 117, 114, 112, 113, 114, 117, 120, 123, 124],
    "Смоленск": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Чита": [137, 136, 132, 125, 119, 116, 117, 119, 124, 130, 133, 136],
    "Калуга": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Орёл": [130, 129, 126, 120, 115, 112, 113, 115, 119, 124, 127, 129],
    "Кострома": [132, 131, 128, 121, 116, 113, 114, 116, 120, 125, 129, 131],
    "Рязань": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Астрахань": [128, 127, 124, 119, 115, 112, 113, 114, 118, 122, 125, 127],
    "Пенза": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Архангельск": [135, 134, 130, 123, 117, 114, 115, 117, 122, 128, 131, 134],
    "Северодвинск": [136, 135, 131, 124, 118, 115, 116, 118, 123, 129, 132, 135],
    "Мурманск": [137, 136, 132, 125, 119, 116, 117, 119, 124, 130, 133, 136],
    "Тверь": [132, 131, 128, 121, 116, 113, 114, 116, 120, 125, 129, 131],
    "Иваново": [132, 131, 128, 121, 116, 113, 114, 116, 120, 125, 129, 131],
    "Белгород": [129, 128, 125, 119, 115, 112, 113, 114, 118, 123, 126, 128],
    "Волжский": [129, 128, 125, 119, 115, 112, 113, 114, 118, 123, 126, 128],
    "Сургут": [138, 137, 133, 126, 120, 117, 118, 120, 125, 131, 134, 137],
    "Новокузнецк": [135, 134, 130, 123, 117, 114, 115, 117, 122, 128, 131, 134],
    "Нижневартовск": [138, 137, 133, 126, 120, 117, 118, 120, 125, 131, 134, 137],
    "Якутск": [140, 139, 135, 128, 122, 119, 120, 122, 127, 133, 136, 139],
    "Подольск": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Химки": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Балашиха": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Мытищи": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Королёв": [131, 130, 127, 120, 115, 112, 113, 115, 119, 124, 128, 130],
    "Грозный": [126, 125, 123, 118, 114, 112, 113, 114, 117, 121, 124, 125],
}

# Insolation data (kWh/m²/day, multiplied by 10 to store as int)
INSOLATION_DATA = {
    "Москва": [6, 12, 20, 31, 43, 48, 46, 38, 24, 14, 7, 5],
    "Санкт-Петербург": [3, 9, 18, 30, 45, 50, 47, 37, 22, 11, 4, 2],
    "Новосибирск": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Екатеринбург": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Казань": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Нижний Новгород": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Челябинск": [6, 12, 21, 32, 44, 49, 47, 37, 23, 13, 7, 5],
    "Самара": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Омск": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Ростов-на-Дону": [15, 20, 30, 41, 53, 58, 59, 51, 36, 23, 15, 12],
    "Уфа": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Красноярск": [4, 10, 20, 31, 43, 48, 46, 36, 22, 12, 5, 3],
    "Воронеж": [8, 14, 23, 34, 46, 51, 50, 40, 26, 16, 9, 7],
    "Пермь": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Волгоград": [12, 18, 28, 39, 51, 56, 57, 49, 34, 21, 13, 10],
    "Краснодар": [16, 21, 31, 42, 54, 59, 60, 52, 37, 24, 16, 13],
    "Саратов": [9, 15, 24, 35, 47, 52, 53, 44, 29, 18, 10, 8],
    "Тюмень": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Тольятти": [7, 13, 22, 33, 45, 50, 49, 39, 25, 15, 8, 6],
    "Ижевск": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Барнаул": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Ульяновск": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Иркутск": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Хабаровск": [10, 15, 24, 33, 43, 45, 41, 38, 28, 18, 10, 8],
    "Ярославль": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Владивосток": [10, 15, 24, 33, 43, 45, 41, 38, 28, 18, 10, 8],
    "Махачкала": [18, 23, 33, 44, 56, 61, 62, 54, 39, 26, 18, 15],
    "Томск": [4, 10, 20, 31, 43, 48, 46, 36, 22, 12, 5, 3],
    "Кемерово": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Набережные Челны": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Оренбург": [12, 18, 28, 39, 51, 56, 57, 49, 34, 21, 13, 10],
    "Тула": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Киров": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Чебоксары": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Калининград": [4, 9, 19, 30, 44, 49, 46, 38, 23, 12, 5, 3],
    "Брянск": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Курск": [8, 14, 23, 34, 46, 51, 50, 40, 26, 16, 9, 7],
    "Липецк": [8, 14, 23, 34, 46, 51, 50, 40, 26, 16, 9, 7],
    "Сочи": [20, 25, 35, 46, 60, 65, 68, 55, 40, 27, 20, 16],
    "Ставрополь": [15, 20, 30, 41, 53, 58, 59, 51, 36, 23, 15, 12],
    "Владикавказ": [17, 22, 32, 43, 55, 60, 61, 53, 38, 25, 17, 14],
    "Смоленск": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Чита": [6, 12, 21, 32, 44, 49, 47, 38, 24, 14, 7, 5],
    "Калуга": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Орёл": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Кострома": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Рязань": [7, 13, 22, 33, 45, 50, 48, 39, 25, 15, 8, 6],
    "Астрахань": [14, 20, 30, 41, 53, 58, 60, 51, 36, 23, 15, 12],
    "Пенза": [8, 14, 23, 34, 46, 51, 50, 40, 26, 16, 9, 7],
    "Архангельск": [2, 7, 17, 32, 42, 47, 42, 32, 17, 7, 2, 1],
    "Северодвинск": [2, 7, 17, 31, 41, 46, 41, 31, 17, 7, 2, 1],
    "Мурманск": [0, 6, 18, 33, 43, 48, 43, 33, 18, 8, 1, 0],
    "Тверь": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Иваново": [5, 11, 20, 31, 43, 48, 46, 36, 22, 12, 6, 4],
    "Белгород": [8, 14, 23, 34, 46, 51, 50, 40, 26, 16, 9, 7],
    "Волжский": [13, 19, 29, 40, 52, 57, 58, 50, 35, 22, 14, 11],
    "Сургут": [3, 8, 18, 30, 42, 47, 45, 35, 21, 11, 4, 2],
    "Новокузнецк": [5, 11, 21, 32, 44, 49, 47, 37, 23, 13, 6, 4],
    "Нижневартовск": [3, 8, 18, 30, 42, 47, 45, 35, 21, 11, 4, 2],
    "Якутск": [3, 9, 20, 35, 47, 52, 50, 40, 25, 14, 5, 2],
    "Подольск": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Химки": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Балашиха": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Мытищи": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Королёв": [6, 12, 20, 31, 43, 48, 46, 37, 23, 13, 7, 5],
    "Грозный": [16, 21, 31, 42, 54, 59, 60, 52, 37, 24, 16, 13],
}

# Wind speed data (m/s, multiplied by 10 to store as int)
WIND_SPEED_DATA = {
    "Москва": [35, 36, 35, 32, 28, 25, 24, 25, 28, 32, 34, 35],
    "Санкт-Петербург": [38, 37, 35, 32, 29, 27, 26, 27, 31, 35, 37, 38],
    "Новосибирск": [32, 33, 34, 36, 34, 31, 29, 30, 32, 35, 34, 32],
    "Екатеринбург": [30, 31, 32, 34, 32, 29, 27, 28, 30, 33, 32, 31],
    "Казань": [34, 35, 34, 32, 29, 26, 25, 26, 29, 33, 34, 34],
    "Нижний Новгород": [33, 34, 33, 30, 27, 24, 23, 24, 27, 31, 33, 33],
    "Челябинск": [34, 35, 36, 38, 35, 32, 30, 31, 34, 37, 36, 35],
    "Самара": [36, 37, 36, 34, 30, 27, 26, 27, 30, 34, 36, 36],
    "Омск": [30, 31, 33, 35, 33, 30, 28, 29, 32, 35, 33, 31],
    "Ростов-на-Дону": [42, 43, 42, 39, 35, 32, 30, 31, 34, 38, 40, 41],
    "Уфа": [35, 36, 35, 33, 30, 27, 26, 27, 30, 34, 35, 35],
    "Красноярск": [25, 26, 28, 30, 29, 26, 24, 25, 27, 29, 28, 26],
    "Воронеж": [40, 41, 40, 37, 33, 30, 29, 30, 33, 37, 39, 40],
    "Пермь": [32, 33, 34, 36, 33, 30, 28, 29, 32, 35, 34, 32],
    "Волгоград": [40, 41, 40, 37, 33, 30, 28, 29, 32, 36, 38, 39],
    "Краснодар": [38, 39, 37, 34, 30, 27, 25, 26, 29, 33, 36, 37],
    "Саратов": [38, 39, 38, 35, 31, 28, 26, 27, 30, 34, 37, 38],
    "Тюмень": [31, 32, 33, 35, 32, 29, 27, 28, 31, 34, 33, 32],
    "Тольятти": [35, 36, 35, 32, 29, 26, 25, 26, 29, 33, 35, 35],
    "Ижевск": [33, 34, 33, 31, 28, 25, 24, 25, 28, 32, 33, 33],
    "Барнаул": [29, 30, 32, 34, 32, 29, 27, 28, 31, 34, 32, 30],
    "Ульяновск": [34, 35, 34, 31, 28, 25, 24, 25, 28, 32, 34, 34],
    "Иркутск": [22, 23, 25, 27, 26, 23, 21, 22, 25, 27, 25, 23],
    "Хабаровск": [28, 29, 32, 36, 38, 35, 32, 33, 36, 35, 31, 29],
    "Ярославль": [34, 35, 34, 31, 28, 25, 24, 25, 28, 32, 34, 34],
    "Владивосток": [65, 62, 58, 52, 45, 40, 38, 42, 50, 58, 63, 65],
    "Махачкала": [35, 36, 35, 32, 29, 26, 25, 26, 29, 33, 35, 35],
    "Томск": [27, 28, 30, 32, 30, 27, 25, 26, 29, 32, 30, 28],
    "Кемерово": [26, 27, 29, 31, 29, 26, 24, 25, 28, 31, 29, 27],
    "Набережные Челны": [33, 34, 33, 31, 28, 25, 24, 25, 28, 32, 33, 33],
    "Оренбург": [42, 43, 42, 39, 35, 32, 30, 31, 34, 38, 40, 41],
    "Тула": [36, 37, 36, 33, 29, 26, 25, 26, 29, 33, 36, 36],
    "Киров": [34, 35, 34, 32, 29, 26, 25, 26, 29, 33, 34, 34],
    "Чебоксары": [35, 36, 35, 32, 29, 26, 25, 26, 29, 33, 35, 35],
    "Калининград": [45, 44, 40, 35, 30, 28, 27, 28, 35, 42, 44, 45],
    "Брянск": [37, 38, 37, 34, 30, 27, 26, 27, 30, 34, 37, 37],
    "Курск": [38, 39, 38, 35, 31, 28, 27, 28, 31, 35, 37, 38],
    "Липецк": [39, 40, 39, 36, 32, 29, 28, 29, 32, 36, 38, 39],
    "Сочи": [22, 23, 23, 21, 20, 19, 19, 20, 21, 22, 22, 22],
    "Ставрополь": [30, 31, 30, 27, 24, 21, 20, 21, 24, 28, 30, 30],
    "Владикавказ": [18, 19, 20, 18, 16, 14, 13, 14, 16, 18, 18, 18],
    "Смоленск": [42, 43, 42, 39, 35, 32, 30, 31, 34, 38, 40, 41],
    "Чита": [23, 24, 26, 28, 27, 24, 22, 23, 26, 28, 26, 24],
    "Калуга": [33, 34, 33, 30, 27, 24, 23, 24, 27, 31, 33, 33],
    "Орёл": [37, 38, 37, 34, 30, 27, 26, 27, 30, 34, 37, 37],
    "Кострома": [32, 33, 32, 29, 26, 23, 22, 23, 26, 30, 32, 32],
    "Рязань": [35, 36, 35, 32, 28, 25, 24, 25, 28, 32, 35, 35],
    "Астрахань": [40, 41, 40, 37, 33, 30, 28, 29, 32, 36, 38, 39],
    "Пенза": [36, 37, 36, 33, 30, 27, 26, 27, 30, 34, 36, 36],
    "Архангельск": [45, 44, 42, 38, 34, 31, 29, 31, 36, 40, 43, 45],
    "Северодвинск": [50, 49, 45, 40, 35, 32, 30, 31, 38, 45, 49, 50],
    "Мурманск": [70, 68, 65, 58, 50, 45, 42, 45, 55, 62, 68, 70],
    "Тверь": [34, 35, 34, 31, 28, 25, 24, 25, 28, 32, 34, 34],
    "Иваново": [33, 34, 33, 30, 27, 24, 23, 24, 27, 31, 33, 33],
    "Белгород": [38, 39, 38, 35, 31, 28, 27, 28, 31, 35, 37, 38],
    "Волжский": [41, 42, 41, 38, 34, 31, 29, 30, 33, 37, 39, 40],
    "Сургут": [38, 39, 40, 42, 40, 37, 35, 36, 39, 42, 40, 39],
    "Новокузнецк": [24, 25, 27, 29, 27, 24, 22, 23, 26, 29, 27, 25],
    "Нижневартовск": [36, 37, 38, 40, 38, 35, 33, 34, 37, 40, 38, 37],
    "Якутск": [18, 19, 21, 23, 22, 20, 18, 19, 22, 24, 21, 19],
    "Подольск": [34, 35, 34, 31, 27, 24, 23, 24, 27, 31, 33, 34],
    "Химки": [35, 36, 35, 32, 28, 25, 24, 25, 28, 32, 34, 35],
    "Балашиха": [34, 35, 34, 31, 27, 24, 23, 24, 27, 31, 33, 34],
    "Мытищи": [33, 34, 33, 30, 26, 23, 22, 23, 26, 30, 32, 33],
    "Королёв": [34, 35, 34, 31, 27, 24, 23, 24, 27, 31, 33, 34],
    "Грозный": [20, 21, 22, 20, 18, 16, 15, 16, 18, 20, 20, 20],
}


async def seed_database(session: AsyncSession) -> None:
    """Seed the database with cities and their parameters."""
    result = await session.execute(select(CityModel).limit(1))
    if result.scalar_one_or_none() is not None:
        return

    for city_name in AIR_DENSITY_DATA.keys():
        city = CityModel(name=city_name)
        session.add(city)
        await session.flush()

        air_density = AIR_DENSITY_DATA[city_name]
        insolation = INSOLATION_DATA[city_name]
        wind_speed = WIND_SPEED_DATA[city_name]

        for i, month in enumerate(MONTHS):
            param = CityParameterModel(
                month=month,
                insolation=insolation[i],
                wind_speed=wind_speed[i],
                air_density=air_density[i],
                city_id=city.id
            )
            session.add(param)

    await session.commit()
